
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Querying &#8212; Dive into Data Science</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupytertip.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pagestyle.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.js"></script>
    <script src="../_static/sphinx_tabs/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GroupBy" href="groupby.html" />
    <link rel="prev" title="Accessing and Sorting" href="accessing.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Dive into Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-getting_started/tools.html">
   Tools of the Trade
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-getting_started/first_steps.html">
   First Steps with Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-getting_started/expressions.html">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-getting_started/variables.html">
   Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-getting_started/functions.html">
   Functions and Imports
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01-getting_started/data_types.html">
   Data Types
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01-getting_started/data_types-numeric.html">
     Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-getting_started/data_types-strings.html">
     Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-getting_started/data_types-bool.html">
     Booleans
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  NumPy and Babypandas
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dataframes.html">
   DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="accessing.html">
   Accessing and Sorting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Querying
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="groupby.html">
   GroupBy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="apply.html">
   Defining and Applying Functions
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../03-visualization/intro.html">
   Plotting with Babypandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-visualization/scatter.html">
   Scatter Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-visualization/line.html">
   Line graphs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-visualization/bar.html">
   Bar charts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-visualization/histogram.html">
   Bar charts
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced Data Manipulation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../04-advanced_data_manipulation/merging.html">
   Merge
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Probability and Simulation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../05-probability_and_simulation/probability_and_simulation.html">
   Probability and simulation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Populations and Samples
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../06-populations_and_samples/1_populations_and_samples.html">
   Populations and Samples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-populations_and_samples/2_parameters_and_statistics.html">
   Parameters and statistics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Hypothesis Testing
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../07-hypothesis_testing/1_hypothesis_tests.html">
   Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-hypothesis_testing/2_permutation_tests.html">
   Permutation Tests
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Estimation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../08-estimation/1_bootstrap.html">
   Parameter Estimation and Bootstrap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-estimation/2_confidence_intervals.html">
   Confidence Intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-estimation/3_ht_using_intervals.html">
   Hypothesis Tests for Parameters using Confidence Intervals
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../how_to_read.html">
   How To Read This Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   All Terms and Tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/02-data_sets/querying.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/eldridgejm/dive_into_data_science"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/eldridgejm/dive_into_data_science/issues/new?title=Issue%20on%20page%20%2F02-data_sets/querying.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        <a class="jupyterhub-button" href="https://datahub.ucsd.edu/hub/user-redirect/git-pull?repo=https://github.com/eldridgejm/dive_into_data_science&urlpath=tree/dive_into_data_science/notebooks/book_pages/02-data_sets/querying.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#querying-with-boolean-arrays">
   Querying with Boolean Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-fires-were-there-in-2018">
     How many fires were there in 2018?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-was-the-combined-size-of-all-fires-in-2018">
     What was the combined size of all fires in 2018?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-percentage-of-all-fires-are-caused-by-arson">
     What percentage of all fires are caused by “arson”?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-fires-from-2018-occurred-in-san-diego-county">
     How many fires from 2018 occurred in San Diego County?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-conditions">
   Multiple Conditions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-operator">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       &amp;
      </span>
     </code>
     Operator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       |
      </span>
     </code>
     Operator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#never-use-and-or">
     Never use
     <code class="docutils literal notranslate">
      <span class="pre">
       and
      </span>
     </code>
     /
     <code class="docutils literal notranslate">
      <span class="pre">
       or
      </span>
     </code>
     !
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#searching-for-a-substring">
   Searching for a Substring
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-trick-to-avoid-spurious-matches">
     A Trick to Avoid Spurious Matches
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-examples">
   More Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-percentage-of-fires-occurred-in-september-or-october">
     What percentage of fires occurred in September or October?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-fires-occurred-between-san-francisco-and-la-in-terms-of-latitude">
     How many fires occurred between San Francisco and LA in terms of latitude?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-fires-larger-than-1000-acres-did-san-diego-have-in-the-1990s">
     How many fires larger than 1000 acres did San Diego have in the 1990s?
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="querying">
<h1>Querying<a class="headerlink" href="#querying" title="Permalink to this headline">¶</a></h1>
<p>The 2018 wildfire season was the worst in California history. How many fires were in 2018? What was their combined size? How many were in San Diego County? These questions could be easily answered if we had a table consisting only of fires from 2018, but our dataset has fires from all years. Creating a new table by selecting only certain rows from an existing table which satisfy some condition is called a <span class="target" id="index-0"></span><strong><a class="reference external" href="../glossary.html#term-query">query</a></strong>. In this section, we’ll see how to perform queries.</p>
<div class="section" id="querying-with-boolean-arrays">
<h2>Querying with Boolean Arrays<a class="headerlink" href="#querying-with-boolean-arrays" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with a simple example. Below, we have created a table containing the population of the five largest cities in California. The table is arranged in alphabetical order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">babypandas</span> <span class="k">as</span> <span class="nn">bpd</span>
<span class="n">populations</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bpd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">City</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fresno&#39;</span><span class="p">,</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;SF&#39;</span><span class="p">,</span> <span class="s1">&#39;SJ&#39;</span><span class="p">],</span>
        <span class="n">Population</span><span class="o">=</span><span class="p">[</span><span class="mi">502_000</span><span class="p">,</span> <span class="mi">4_094_000</span><span class="p">,</span> <span class="mi">1_376_000</span><span class="p">,</span> <span class="mi">856_000</span><span class="p">,</span> <span class="mi">1_023_000</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">populations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fresno</th>
      <td>502000</td>
    </tr>
    <tr>
      <th>LA</th>
      <td>4094000</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>1376000</td>
    </tr>
    <tr>
      <th>SF</th>
      <td>856000</td>
    </tr>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition tip" id="tip-0">
<p class="admonition-title">Tip</p>
<p>To create a table by hand, start by creating an empty DataFrame with <code class="docutils literal notranslate"><span class="pre">bpd.DataFrame()</span></code>, then use <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to add columns to the table.</p>
</div>
<p>Suppose we want to know which cities have populations larger than 1 million. We can do so with the following <strong>query</strong>, the result of which is a new table consisting only of the cities whose population is greater than 1 million.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="p">[</span><span class="n">populations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LA</th>
      <td>4094000</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>1376000</td>
    </tr>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s take a deeper look at what is going on insider of a query. At it’s heart is a <em>comparison</em>: <code class="docutils literal notranslate"><span class="pre">populations.get('Population')</span> <span class="pre">&gt;</span> <span class="pre">1_000_000</span></code>. Recall from <a class="reference internal" href="../01-getting_started/data_types-bool.html"><span class="doc">Booleans</span></a> that a comparison between two numbers results in a <span class="target" id="index-1"></span><strong><a class="reference external" href="../glossary.html#term-boolean">Boolean</a></strong> value (that is, the result is either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>). For instance, is we ask if 2 million is larger than 1 million, we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2_000_000</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Now, in this case of <code class="docutils literal notranslate"><span class="pre">populations.get('Population')</span> <span class="pre">&gt;</span> <span class="pre">1_000_000</span></code>, we are comparing an entire column of the table to a single number, <code class="docutils literal notranslate"><span class="pre">1_000_000</span></code>. What will be the result? As with arithmetic on a table column, comparisons are performed elementwise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Fresno    False
LA         True
SD         True
SF        False
SJ         True
Name: Population, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>The result is a Series with one entry for every row of the original table. The Series is <code class="docutils literal notranslate"><span class="pre">True</span></code> where the comparison is true and <code class="docutils literal notranslate"><span class="pre">False</span></code> where the comparison is not true. Because each entry of the Series is a Boolean, the result is called a <span class="target" id="index-2"></span><strong><a class="reference external" href="../glossary.html#term-boolean-array">Boolean array</a></strong> (or, more precisely, a <strong>Boolean series</strong>). The entries of the Boolean array tell us exactly which rows to keep and which rows to discard. If an entry is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we want to keep the corresponding row of the table – if it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, we should discard that row.</p>
<p>We can carry out the query and produce a new table by passing the Boolean array into the table using square bracket notation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="p">[</span><span class="n">populations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LA</th>
      <td>4094000</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>1376000</td>
    </tr>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition tip" id="tip-1">
<p class="admonition-title">Tip</p>
<p>Using square brackets on a table can be read aloud as “<em>where</em>”.</p>
<p>So the expression</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="p">[</span><span class="n">populations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">]</span>
</pre></div>
</div>
<p>is read as “the rows <em>where</em> the populations is greater than 1 million”.</p>
</div>
<p>It should be mentioned that <em>any</em> Boolean array whose length matches the number of rows in the table can be used to select a subset of the table’s rows. For instance, we could construct our own Boolean array by hand and get the same result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LA</th>
      <td>4094000</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>1376000</td>
    </tr>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, it’s usually much more convenient to create the Boolean arrays with comparisons, like <code class="docutils literal notranslate"><span class="pre">populations.get('Population')</span> <span class="pre">&gt;</span> <span class="pre">1_000_000</span></code>.</p>
<p>Lastly, note that if no row satisfies your condition, an empty table will be returned. For instance, no cities have more than 10 million people:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">populations</span><span class="p">[</span><span class="n">populations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000_000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Let’s get some practice with querying on a larger data set. For this, we’ll use the full dataset of California wildfires. While the wildfire dataset we saw previously contained only the 50 largest fires in California history, this dataset will contain <em>all named fires</em> since the late 1800’s. It is in a file called <code class="docutils literal notranslate"><span class="pre">calfire-full.csv</span></code> in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/calfire-full.csv&#39;</span><span class="p">)</span>
<span class="n">calfire</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>name</th>
      <th>cause</th>
      <th>acres</th>
      <th>county</th>
      <th>longitude</th>
      <th>latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1898</td>
      <td>9</td>
      <td>LOS PADRES</td>
      <td>14 - Unknown</td>
      <td>20539.949219</td>
      <td>Ventura</td>
      <td>-119.367830</td>
      <td>34.446830</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1898</td>
      <td>4</td>
      <td>MATILIJA</td>
      <td>14 - Unknown</td>
      <td>2641.123047</td>
      <td>Ventura</td>
      <td>-119.299625</td>
      <td>34.488614</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1898</td>
      <td>9</td>
      <td>COZY DELL</td>
      <td>14 - Unknown</td>
      <td>2974.585205</td>
      <td>Ventura</td>
      <td>-119.265380</td>
      <td>34.482316</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1902</td>
      <td>8</td>
      <td>FEROUD</td>
      <td>14 - Unknown</td>
      <td>731.481567</td>
      <td>Ventura</td>
      <td>-119.320979</td>
      <td>34.417515</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1903</td>
      <td>10</td>
      <td>SAN ANTONIO</td>
      <td>14 - Unknown</td>
      <td>380.260590</td>
      <td>Ventura</td>
      <td>-119.253422</td>
      <td>34.430616</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13459</th>
      <td>2019</td>
      <td>9</td>
      <td>STAGE</td>
      <td>7 - Arson</td>
      <td>13.019149</td>
      <td>Monterey</td>
      <td>-121.599207</td>
      <td>36.764065</td>
    </tr>
    <tr>
      <th>13460</th>
      <td>2019</td>
      <td>10</td>
      <td>CROSS</td>
      <td>14 - Unknown</td>
      <td>289.151428</td>
      <td>Monterey</td>
      <td>-120.726245</td>
      <td>35.793698</td>
    </tr>
    <tr>
      <th>13461</th>
      <td>2019</td>
      <td>9</td>
      <td>FRUDDEN</td>
      <td>2 - Equipment Use</td>
      <td>11.789393</td>
      <td>Monterey</td>
      <td>-120.908061</td>
      <td>35.908627</td>
    </tr>
    <tr>
      <th>13462</th>
      <td>2019</td>
      <td>9</td>
      <td>JOLON</td>
      <td>11 - Powerline</td>
      <td>61.592369</td>
      <td>Monterey</td>
      <td>-121.010025</td>
      <td>35.910750</td>
    </tr>
    <tr>
      <th>13463</th>
      <td>2019</td>
      <td>10</td>
      <td>SADDLE RIDGE</td>
      <td>14 - Unknown</td>
      <td>8799.325195</td>
      <td>Los Angeles</td>
      <td>-118.516473</td>
      <td>34.321859</td>
    </tr>
  </tbody>
</table>
<p>13464 rows × 8 columns</p>
</div></div></div>
</div>
<p>Notice that we haven’t set the index of the table. The natural choice of index would be the <code class="docutils literal notranslate"><span class="pre">'name'</span></code> column, but it turns out that several fires have the same name. Remember that row labels should be unique!</p>
<div class="section" id="how-many-fires-were-there-in-2018">
<h3>How many fires were there in 2018?<a class="headerlink" href="#how-many-fires-were-there-in-2018" title="Permalink to this headline">¶</a></h3>
<p>We can determine how many fires there were in 2018 by selecting only those rows where the <code class="docutils literal notranslate"><span class="pre">'year'</span></code> value is equal to 2018 and calculating the size of the resulting table. Remember: to ask if two values are equal, we use <code class="docutils literal notranslate"><span class="pre">==</span></code>, not <code class="docutils literal notranslate"><span class="pre">=</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>name</th>
      <th>cause</th>
      <th>acres</th>
      <th>county</th>
      <th>longitude</th>
      <th>latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12772</th>
      <td>2018</td>
      <td>7</td>
      <td>LAGUNA</td>
      <td>2 - Equipment Use</td>
      <td>1.116125</td>
      <td>San Luis Obispo</td>
      <td>-120.632741</td>
      <td>35.588189</td>
    </tr>
    <tr>
      <th>12773</th>
      <td>2018</td>
      <td>12</td>
      <td>OAK</td>
      <td>11 - Powerline</td>
      <td>2.180850</td>
      <td>Los Angeles</td>
      <td>-118.692809</td>
      <td>34.473468</td>
    </tr>
    <tr>
      <th>12774</th>
      <td>2018</td>
      <td>11</td>
      <td>COPCO</td>
      <td>9 - Miscellaneous</td>
      <td>6.980345</td>
      <td>Los Angeles</td>
      <td>-118.797409</td>
      <td>34.720091</td>
    </tr>
    <tr>
      <th>12775</th>
      <td>2018</td>
      <td>10</td>
      <td>SANTA MARIA</td>
      <td>14 - Unknown</td>
      <td>1.347234</td>
      <td>Los Angeles</td>
      <td>-118.592681</td>
      <td>34.123768</td>
    </tr>
    <tr>
      <th>12776</th>
      <td>2018</td>
      <td>10</td>
      <td>MUREAU</td>
      <td>11 - Powerline</td>
      <td>0.133597</td>
      <td>Los Angeles</td>
      <td>-118.678461</td>
      <td>34.151321</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13164</th>
      <td>2018</td>
      <td>4</td>
      <td>HARBOR</td>
      <td>14 - Unknown</td>
      <td>0.392633</td>
      <td>Ventura</td>
      <td>-119.247964</td>
      <td>34.214345</td>
    </tr>
    <tr>
      <th>13165</th>
      <td>2018</td>
      <td>1</td>
      <td>ERBES</td>
      <td>14 - Unknown</td>
      <td>0.028838</td>
      <td>Ventura</td>
      <td>-118.846409</td>
      <td>34.235447</td>
    </tr>
    <tr>
      <th>13166</th>
      <td>2018</td>
      <td>10</td>
      <td>GRIMES</td>
      <td>2 - Equipment Use</td>
      <td>0.202070</td>
      <td>Ventura</td>
      <td>-118.904546</td>
      <td>34.343482</td>
    </tr>
    <tr>
      <th>13167</th>
      <td>2018</td>
      <td>6</td>
      <td>BEACH</td>
      <td>9 - Miscellaneous</td>
      <td>0.521827</td>
      <td>Ventura</td>
      <td>-119.341277</td>
      <td>34.298223</td>
    </tr>
    <tr>
      <th>13168</th>
      <td>2018</td>
      <td>7</td>
      <td>ROLLING</td>
      <td>14 - Unknown</td>
      <td>0.007145</td>
      <td>Ventura</td>
      <td>-118.868440</td>
      <td>34.174372</td>
    </tr>
  </tbody>
</table>
<p>397 rows × 8 columns</p>
</div></div></div>
</div>
<p>The resulting table has 397 rows, which means that there were 397 fires in 2018. We could also get this information with code by using the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>397
</pre></div>
</div>
</div>
</div>
<p>In reality, there were probably many more wildfires than this: the dataset contains only those fires which were large enough to be named.</p>
</div>
<div class="section" id="what-was-the-combined-size-of-all-fires-in-2018">
<h3>What was the combined size of all fires in 2018?<a class="headerlink" href="#what-was-the-combined-size-of-all-fires-in-2018" title="Permalink to this headline">¶</a></h3>
<p>We know how to retrieve only those fires from 2018; we did this above with <code class="docutils literal notranslate"><span class="pre">calfire[calfire.get('year')</span> <span class="pre">==</span> <span class="pre">2018]</span></code>. Now we simply ask for the sum of the <code class="docutils literal notranslate"><span class="pre">'acres'</span></code> column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_burned_2018</span> <span class="o">=</span> <span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;acres&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">area_burned_2018</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1586074.870139362
</pre></div>
</div>
</div>
</div>
<p>That certainly <em>seems</em> like a large number, but let’s put it in perspective. The island of Manhattan is 14,600 acres in area. Therefore, the area burned in 2018 was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">area_burned_2018</span> <span class="o">/</span> <span class="mi">14_600</span><span class="p">,</span> <span class="s1">&#39;times the size of Manhattan.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>108.6352650780385 times the size of Manhattan.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="what-percentage-of-all-fires-are-caused-by-arson">
<h3>What percentage of all fires are caused by “arson”?<a class="headerlink" href="#what-percentage-of-all-fires-are-caused-by-arson" title="Permalink to this headline">¶</a></h3>
<p>We want to select the rows where the cause is due to someone deliberately setting the fire. The <code class="docutils literal notranslate"><span class="pre">'cause'</span></code> column, however, contains strings in a special format, such as <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">Lightning</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">-</span> <span class="pre">Eqipment</span> <span class="pre">Use</span></code>, and so on. To select the fires caused by arson we need to know the exact string to search for.</p>
<p>We can get this information by asking for the unique values that appear in a column with the <code class="docutils literal notranslate"><span class="pre">.unique</span></code> Series method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cause&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;14 - Unknown&#39;, &#39;7 - Arson&#39;, &#39;4 - Campfire&#39;, &#39;1 - Lightning&#39;,
       &#39;9 - Miscellaneous&#39;, &#39;5 - Debris&#39;, &#39;8 - Playing with fire&#39;,
       &#39;3 - Smoking&#39;, &#39;15 - Structure&#39;, &#39;2 - Equipment Use&#39;,
       &#39;10 - Vehicle&#39;, &#39;6 - Railroad&#39;, &#39;18 - Escaped Prescribed Burn&#39;,
       &#39;11 - Powerline&#39;, &#39;16 - Aircraft&#39;, &#39;12 - Firefighter Training&#39;,
       &#39;13 - Non-Firefighter Training&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>It looks like the right string for arson is <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">-</span> <span class="pre">Arson</span></code>. Let’s perform the query:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arsons</span> <span class="o">=</span> <span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cause&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;7 - Arson&#39;</span><span class="p">]</span>
<span class="n">arsons</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>name</th>
      <th>cause</th>
      <th>acres</th>
      <th>county</th>
      <th>longitude</th>
      <th>latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>1910</td>
      <td>8</td>
      <td>CRAWFORD CREEK 2</td>
      <td>7 - Arson</td>
      <td>497.885071</td>
      <td>Humboldt</td>
      <td>-123.552471</td>
      <td>41.300052</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1911</td>
      <td>7</td>
      <td>ORCUTT FLAT</td>
      <td>7 - Arson</td>
      <td>94.598785</td>
      <td>Humboldt</td>
      <td>-123.515171</td>
      <td>41.319056</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1911</td>
      <td>7</td>
      <td>PRIGMORE FLAT</td>
      <td>7 - Arson</td>
      <td>14.936650</td>
      <td>Humboldt</td>
      <td>-123.520594</td>
      <td>41.288310</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1911</td>
      <td>8</td>
      <td>ULLATHORNE CREEK</td>
      <td>7 - Arson</td>
      <td>9.957536</td>
      <td>Humboldt</td>
      <td>-123.576445</td>
      <td>41.289008</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1911</td>
      <td>8</td>
      <td>PEARCH CREEK</td>
      <td>7 - Arson</td>
      <td>398.317413</td>
      <td>Humboldt</td>
      <td>-123.495326</td>
      <td>41.302627</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13387</th>
      <td>2019</td>
      <td>9</td>
      <td>FRAME</td>
      <td>7 - Arson</td>
      <td>15.022148</td>
      <td>Fresno</td>
      <td>-120.649290</td>
      <td>36.163830</td>
    </tr>
    <tr>
      <th>13405</th>
      <td>2019</td>
      <td>3</td>
      <td>LINCOLN</td>
      <td>7 - Arson</td>
      <td>564.215393</td>
      <td>Riverside</td>
      <td>-116.072059</td>
      <td>33.534968</td>
    </tr>
    <tr>
      <th>13409</th>
      <td>2019</td>
      <td>8</td>
      <td>PATTERSON</td>
      <td>7 - Arson</td>
      <td>139.200714</td>
      <td>San Joaquin</td>
      <td>-121.538773</td>
      <td>37.715312</td>
    </tr>
    <tr>
      <th>13425</th>
      <td>2019</td>
      <td>8</td>
      <td>MARSH 5</td>
      <td>7 - Arson</td>
      <td>226.616867</td>
      <td>Contra Costa</td>
      <td>-121.828352</td>
      <td>37.888016</td>
    </tr>
    <tr>
      <th>13459</th>
      <td>2019</td>
      <td>9</td>
      <td>STAGE</td>
      <td>7 - Arson</td>
      <td>13.019149</td>
      <td>Monterey</td>
      <td>-121.599207</td>
      <td>36.764065</td>
    </tr>
  </tbody>
</table>
<p>763 rows × 8 columns</p>
</div></div></div>
</div>
<p>To find the percentage of fires caused by arson, we divide the size of this table by the size of the original table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arsons</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">calfire</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05666963755199049
</pre></div>
</div>
</div>
</div>
<p>So about 5-6% of all wildfires are known to be caused by arson.</p>
</div>
<div class="section" id="how-many-fires-from-2018-occurred-in-san-diego-county">
<h3>How many fires from 2018 occurred in San Diego County?<a class="headerlink" href="#how-many-fires-from-2018-occurred-in-san-diego-county" title="Permalink to this headline">¶</a></h3>
<p>We can answer this question by first selecting only the rows from 2018. Using this smaller table, we’ll select the rows from San Diego County. This two step process is slightly cumbersome, however – in the next section, we’ll see a better way of performing the same query.</p>
<p>First, we’ll get the fires from 2018:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fires_from_2018</span> <span class="o">=</span> <span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’ll select only the fires from San Diego County, making sure to use <code class="docutils literal notranslate"><span class="pre">fires_from_2018</span></code>, and not <code class="docutils literal notranslate"><span class="pre">calfires</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fires_from_2018</span><span class="p">[</span><span class="n">fires_from_2018</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;San Diego&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>name</th>
      <th>cause</th>
      <th>acres</th>
      <th>county</th>
      <th>longitude</th>
      <th>latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12800</th>
      <td>2018</td>
      <td>7</td>
      <td>PASQUAL</td>
      <td>14 - Unknown</td>
      <td>327.586121</td>
      <td>San Diego</td>
      <td>-116.917288</td>
      <td>33.078967</td>
    </tr>
    <tr>
      <th>12819</th>
      <td>2018</td>
      <td>3</td>
      <td>MCP BASILONE GATE</td>
      <td>14 - Unknown</td>
      <td>0.023540</td>
      <td>San Diego</td>
      <td>-117.559119</td>
      <td>33.440113</td>
    </tr>
    <tr>
      <th>12821</th>
      <td>2018</td>
      <td>8</td>
      <td>SAN MATEO CAMPGROUND</td>
      <td>14 - Unknown</td>
      <td>2.909111</td>
      <td>San Diego</td>
      <td>-117.572772</td>
      <td>33.419019</td>
    </tr>
    <tr>
      <th>12889</th>
      <td>2018</td>
      <td>5</td>
      <td>MONTE</td>
      <td>14 - Unknown</td>
      <td>13.088419</td>
      <td>San Diego</td>
      <td>-116.767460</td>
      <td>32.896771</td>
    </tr>
    <tr>
      <th>12968</th>
      <td>2018</td>
      <td>7</td>
      <td>WEST</td>
      <td>2 - Equipment Use</td>
      <td>505.399994</td>
      <td>San Diego</td>
      <td>-116.745126</td>
      <td>32.829008</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>2018</td>
      <td>7</td>
      <td>ROCK 5</td>
      <td>14 - Unknown</td>
      <td>206.256805</td>
      <td>San Diego</td>
      <td>-117.236669</td>
      <td>33.419540</td>
    </tr>
    <tr>
      <th>13069</th>
      <td>2018</td>
      <td>6</td>
      <td>RECYCLE</td>
      <td>4 - Campfire</td>
      <td>248.380676</td>
      <td>San Diego</td>
      <td>-116.443775</td>
      <td>32.654185</td>
    </tr>
    <tr>
      <th>13071</th>
      <td>2018</td>
      <td>5</td>
      <td>AGUA</td>
      <td>14 - Unknown</td>
      <td>59.082077</td>
      <td>San Diego</td>
      <td>-117.028463</td>
      <td>33.363286</td>
    </tr>
    <tr>
      <th>13141</th>
      <td>2018</td>
      <td>6</td>
      <td>CHURCH 2</td>
      <td>10 - Vehicle</td>
      <td>11.045366</td>
      <td>San Diego</td>
      <td>-116.359866</td>
      <td>32.687008</td>
    </tr>
    <tr>
      <th>13142</th>
      <td>2018</td>
      <td>7</td>
      <td>BUILDING</td>
      <td>9 - Miscellaneous</td>
      <td>10.419848</td>
      <td>San Diego</td>
      <td>-116.766340</td>
      <td>32.620508</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 8 columns</p>
</div></div></div>
</div>
<p>It seems that there were 13 such fires.</p>
</div>
</div>
<div class="section" id="multiple-conditions">
<h2>Multiple Conditions<a class="headerlink" href="#multiple-conditions" title="Permalink to this headline">¶</a></h2>
<p>How many fires did San Diego County have in 2018? We saw above that this can be answered with two queries, one after the other. But a more direct and arguably better way is to construct a query with <em>multiple conditions</em>, as we’ll do now.</p>
<div class="section" id="the-operator">
<h3>The <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> Operator<a class="headerlink" href="#the-operator" title="Permalink to this headline">¶</a></h3>
<p>Let’s begin with another simple example. Below is the table of city populations that we saw at the beginning of this section, but with an additional column containing the region of California that the city is in:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">City</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fresno&#39;</span><span class="p">,</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;SF&#39;</span><span class="p">,</span> <span class="s1">&#39;SJ&#39;</span><span class="p">],</span>
    <span class="n">Population</span><span class="o">=</span><span class="p">[</span><span class="mi">502_000</span><span class="p">,</span> <span class="mi">4_094_000</span><span class="p">,</span> <span class="mi">1_376_000</span><span class="p">,</span> <span class="mi">856_000</span><span class="p">,</span> <span class="mi">1_023_000</span><span class="p">],</span>
    <span class="n">Region</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Central Valley&#39;</span><span class="p">,</span> <span class="s1">&#39;SoCal&#39;</span><span class="p">,</span> <span class="s1">&#39;SoCal&#39;</span><span class="p">,</span> <span class="s1">&#39;NorCal&#39;</span><span class="p">,</span> <span class="s1">&#39;NorCal&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">)</span>
<span class="n">with_regions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
      <th>Region</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fresno</th>
      <td>502000</td>
      <td>Central Valley</td>
    </tr>
    <tr>
      <th>LA</th>
      <td>4094000</td>
      <td>SoCal</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>1376000</td>
      <td>SoCal</td>
    </tr>
    <tr>
      <th>SF</th>
      <td>856000</td>
      <td>NorCal</td>
    </tr>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
      <td>NorCal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Suppose we want to select only those cities which 1) have population larger than 1 million, and 2) are in NorCal (Northern California).</p>
<p>We know how to make Boolean arrays for both queries individually:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_more_than_a_million</span> <span class="o">=</span> <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span>
<span class="n">is_more_than_a_million</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Fresno    False
LA         True
SD         True
SF        False
SJ         True
Name: Population, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_in_norcal</span> <span class="o">=</span> <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span>
<span class="n">is_in_norcal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Fresno    False
LA        False
SD        False
SF         True
SJ         True
Name: Region, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>But we want a Boolean array where an entry is <code class="docutils literal notranslate"><span class="pre">True</span></code> if (and only if) <em>both</em> of the corresponding entries from <code class="docutils literal notranslate"><span class="pre">is_more_than_a_million</span></code> and <code class="docutils literal notranslate"><span class="pre">is_in_norcal</span></code> are <code class="docutils literal notranslate"><span class="pre">True</span></code>. In other words, an entry should be true if the population is above 1 million <em>and</em> the region is NorCal.</p>
<p>We can construct such an array using the <em>binary and</em> <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator. <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> takes two Boolean arrays of the same size and returns a new Boolean array that is True only when the input arrays are <em>both</em> True.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_more_than_a_million</span> <span class="o">&amp;</span> <span class="n">is_in_norcal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Fresno    False
LA        False
SD        False
SF        False
SJ         True
dtype: bool
</pre></div>
</div>
</div>
</div>
<p>You can check that each entry in this new Boolean array is <code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if the corresponding entries in <code class="docutils literal notranslate"><span class="pre">is_more_than_a_million</span></code> and <code class="docutils literal notranslate"><span class="pre">is_in_norcal</span></code> are both <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>We can now pass this new array into the table to select only the desired rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span><span class="p">[</span><span class="n">is_more_than_a_million</span> <span class="o">&amp;</span> <span class="n">is_in_norcal</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
      <th>Region</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
      <td>NorCal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, we’ve assigned each of the two queries to intermediate variables, <code class="docutils literal notranslate"><span class="pre">is_more_than_a_million</span></code> and <code class="docutils literal notranslate"><span class="pre">is_in_norcal</span></code>. This is totally fine, but many times we’ll save ourselves the extra typing by writing the query in one line of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span><span class="p">[</span>
    <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
      <th>Region</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SJ</th>
      <td>1023000</td>
      <td>NorCal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice the <code class="docutils literal notranslate"><span class="pre">()</span></code> around each individual comparison. These are extremely important! If you don’t include these, you’ll get yelled at by Python:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span><span class="p">[</span>
    <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span> <span class="o">&amp;</span> <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">24</span><span class="o">-</span><span class="mi">9</span><span class="n">d9087344376</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">with_regions</span><span class="p">[</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span> <span class="o">&amp;</span> <span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="p">]</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for &amp;: &#39;int&#39; and &#39;Series&#39;
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Always include parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code> around separate conditions in a query with multiple conditions. If you are performing a query, and you see a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> complaining about an “unsupported operand type”, it is likely due to forgetting the parentheses.</p>
</div>
<div class="jupytertip admonition" id="jupytertip-0">
<p class="admonition-title">Jupyter Tip</p>
<p>If you forgot parentheses and want to add them quickly, you can select the section of code you want to surround in parentheses and then type <code class="docutils literal notranslate"><span class="pre">(</span></code>. Jupyter will wrap your entire selection in a single pair of parentheses.</p>
</div>
<p>Lastly, Python is all about readability and  a e s t h e t i c.</p>
<p>If we’re inside of parentheses or brackets, we can break up long lines of code to make them easier to read and understand:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span><span class="p">[</span>
    <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-0-0 docutils container">
<div class="docutils container">
<p>Question</p>
</div>
</div>
<div class="item sphinx-data-tab-0-1 docutils container">
<div class="docutils container">
<p>Answer</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-0 active docutils container">
<p>How would you use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to select all ‘Class E’ fires – fires which burned at least 300 acres (inclusive) but less than 1000 acres?</p>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-1 docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[(</span><span class="n">fires</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;acres&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">300</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fires</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;acres&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>The <code class="docutils literal notranslate"><span class="pre">|</span></code> Operator<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Suppose we wanted to select all fires which occurred in either San Diego County <em>or</em> Imperial County. In this situation,
we use the <em>binary or</em> operator, <code class="docutils literal notranslate"><span class="pre">|</span></code>. This operator takes two Boolean arrays of the same size as input and creates a new array in which a particular entry is <code class="docutils literal notranslate"><span class="pre">True</span></code> if <em>at least one</em> of the corresponding entries in the input arrays is true.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_san_diego</span> <span class="o">=</span> <span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;San Diego&quot;</span>
<span class="n">in_imperial</span> <span class="o">=</span> <span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Imperial&quot;</span>

<span class="n">calfire</span><span class="p">[</span><span class="n">in_imperial</span> <span class="o">|</span> <span class="n">in_san_diego</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="never-use-and-or">
<h3>Never use <code class="docutils literal notranslate"><span class="pre">and</span></code> / <code class="docutils literal notranslate"><span class="pre">or</span></code>!<a class="headerlink" href="#never-use-and-or" title="Permalink to this headline">¶</a></h3>
<p>You might know that <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> are valid Python keywords and might wonder why we use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code> instead. In fact, <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> <em>do not</em> perform the right type of comparison when working with arrays. Your code <em>will</em> run, but it will give you the wrong result. Here’s a quick example. Suppose we want to get all cities in NorCal with populations larger than 1 million. We write a compound query, but use <code class="docutils literal notranslate"><span class="pre">and</span></code> instead of <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. The code runs, but is the result correct?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">with_regions</span><span class="p">[</span>
    <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1_000_000</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">with_regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NorCal&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that SF has been included, even though its population is less than 1 million! Why is this? The short answer is that <code class="docutils literal notranslate"><span class="pre">and</span></code> does not do the same thing as <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. Remember that <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> works elementwise on arrays, returning a new array which is <code class="docutils literal notranslate"><span class="pre">True</span></code> only where both of the input arrays are <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s try the same thing, but with <code class="docutils literal notranslate"><span class="pre">and</span></code> instead of <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span> <span class="ow">and</span> <span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>That’s not what we expected!</p>
<p>For the purposes of this textbook, it’s enough to know that <code class="docutils literal notranslate"><span class="pre">and</span></code> doesn’t do the same thing as <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. But if you’re curious as to why this happens, here’s the short version. We know that Python has Boolean literals <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code>, and <code class="docutils literal notranslate"><span class="pre">and</span></code> works with them as you’d expect:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span> <span class="ow">and</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span> <span class="ow">and</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>But Python also assigns truth value to other things, like lists and strings. For instance, it is often useful to treat an empty list as if is is <code class="docutils literal notranslate"><span class="pre">False</span></code>, and a non-empty list as if it is <code class="docutils literal notranslate"><span class="pre">True</span></code>. We can see the truth value Python assigns to something by using the <code class="docutils literal notranslate"><span class="pre">bool</span></code> function to convert it to a Boolean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span><span class="p">([])</span>
</pre></div>
</div>
</div>
</div>
<p>Because of this, we can use <code class="docutils literal notranslate"><span class="pre">and</span></code> between things that aren’t <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>. For instance, we can put it between two lists to make sure that both are non-empty:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the output isn’t <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, it is a list! If we really wanted <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> for some reason, we could do so with <code class="docutils literal notranslate"><span class="pre">bool()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
</div>
<p>But this is the key:  apparently, <code class="docutils literal notranslate"><span class="pre">and</span></code> will produce the second list if both are non-empty. The same thing happens if we use <code class="docutils literal notranslate"><span class="pre">and</span></code> between Boolean series. Take another look at our example from above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span> <span class="ow">and</span> <span class="n">bpd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that what is returned is actually the array on the right hand side of <code class="docutils literal notranslate"><span class="pre">and</span></code>! This almost never what we want when comparing arrays, so remember the following warning:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Never use <code class="docutils literal notranslate"><span class="pre">and</span></code> when writing comparisons in a query. Always use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. Likewise, never use <code class="docutils literal notranslate"><span class="pre">or</span></code>; always use <code class="docutils literal notranslate"><span class="pre">|</span></code>.</p>
</div>
<p>We will use <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> later on when writing conditionals.</p>
</div>
</div>
<div class="section" id="searching-for-a-substring">
<h2>Searching for a Substring<a class="headerlink" href="#searching-for-a-substring" title="Permalink to this headline">¶</a></h2>
<p>Wildfires are typically named after the place where they started. For example, fires that start near the border between California and another state or Mexico are often named something like “BORDER #6”, or “BORDER #12”, etc. We know how to write a query to select all fires with a specific name. For instance, it turns out that there are multiple fires called “BORDER#2”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;BORDER#2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>But how do we retrieve all fires with “BORDER” somewhere in their names? It turns out that <em>babypandas</em> includes a helpful Series method called <code class="docutils literal notranslate"><span class="pre">.str.contains</span></code> which can help us do exactly this. It accepts one argument – a string – and searches for it within each entry of the Series, returning a Boolean array. For instance, to find the fires with “BORDER” in their name, we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;BORDER&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-trick-to-avoid-spurious-matches">
<h3>A Trick to Avoid Spurious Matches<a class="headerlink" href="#a-trick-to-avoid-spurious-matches" title="Permalink to this headline">¶</a></h3>
<p>Many fires are named after roads. Let’s count how many:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;ROAD&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>We see several “good” matches, like “NIELSON ROAD” and “CUTOFF ROAD”, but several “spurious” matches, like “ROADRUNNER”, and “RAILROAD”. How can we exclude these fires?</p>
<p>Here’s a trick: instead of searching for strings containing <code class="docutils literal notranslate"><span class="pre">'ROAD'</span></code>, we’ll search for strings containing <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">ROAD'</span></code>,
where we have added a space to the beginning of the search string. This will match strings like “CUTOFF ROAD”, but not “RAILROAD”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39; ROAD&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Strings have other useful string methods, as well. In this case, all of the fire names are capitalized, but it is common to find that datasets are inconsistent in their capitalization. For instance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cities</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;San Diego&#39;</span><span class="p">,</span> <span class="s1">&#39;los angeles&#39;</span><span class="p">,</span> <span class="s1">&#39;san luis obispo&#39;</span><span class="p">,</span> <span class="s1">&#39;Oakland&#39;</span><span class="p">,</span> <span class="s1">&#39;Stockton&#39;</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Note that some of the strings are not capitalized, while others are. If we want to retrieve all strings that contain <code class="docutils literal notranslate"><span class="pre">San</span></code>, we’ll have to write two queries: one for <code class="docutils literal notranslate"><span class="pre">San</span></code> and another for <code class="docutils literal notranslate"><span class="pre">san</span></code>. But there’s an easier way.</p>
<p>A common practice is to make sure all of your text data for a given column is in the same capitalization before selecting on substrings. We can chain together the <code class="docutils literal notranslate"><span class="pre">.str.lower</span></code> method with the <code class="docutils literal notranslate"><span class="pre">.str.contains</span></code> method to quickly achieve this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cities</span><span class="p">[</span><span class="n">cities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;san&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>It’s worth noting that if you try using the <code class="docutils literal notranslate"><span class="pre">.str</span></code> methods on a Series that doesn’t contain text, you’ll encounter a helpful error (once you scroll to the bottom).</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;2019&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition tip" id="tip-2">
<p class="admonition-title">Tip</p>
<p>Often times, when reading an error message it’s most helpful to look at the two ends of the message – and don’t get too worried about the middle bits.</p>
<p>The very top line points to <em>where</em> the error occurred, and the very bottom lines explain <em>why</em> the error occurred.</p>
</div>
</div>
</div>
<div class="section" id="more-examples">
<h2>More Examples<a class="headerlink" href="#more-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-percentage-of-fires-occurred-in-september-or-october">
<h3>What percentage of fires occurred in September or October?<a class="headerlink" href="#what-percentage-of-fires-occurred-in-september-or-october" title="Permalink to this headline">¶</a></h3>
<p>We’ll use <code class="docutils literal notranslate"><span class="pre">|</span></code> to find those fires whose <code class="docutils literal notranslate"><span class="pre">'month'</span></code> is either 9 or 10:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sept_or_oct</span> <span class="o">=</span> <span class="n">calfire</span><span class="p">[(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)]</span>
<span class="n">sept_or_oct</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">calfire</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-many-fires-occurred-between-san-francisco-and-la-in-terms-of-latitude">
<h3>How many fires occurred between San Francisco and LA in terms of latitude?<a class="headerlink" href="#how-many-fires-occurred-between-san-francisco-and-la-in-terms-of-latitude" title="Permalink to this headline">¶</a></h3>
<p>The latitude of San Francisco is 37.7749, while the latitude of LA is 34.0522. Selecting all fires within this range can be done with <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span>
    <span class="p">(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">37.7749</span><span class="p">)</span>
    <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">34.0522</span><span class="p">)</span>
<span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-many-fires-larger-than-1000-acres-did-san-diego-have-in-the-1990s">
<h3>How many fires larger than 1000 acres did San Diego have in the 1990s?<a class="headerlink" href="#how-many-fires-larger-than-1000-acres-did-san-diego-have-in-the-1990s" title="Permalink to this headline">¶</a></h3>
<p>Now we’re having fun! There are three conditions here: 1) Larger than 1000 acres, 2) in San Diego County, and 3) in the 1990s. The third condition, however, is actually two conditions: after 1990 and before 2000.</p>
<p>With a complex query like this, it’s probably best to make the three Boolean arrays separately and save them in intermediate variables, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_gt_1000_acres</span> <span class="o">=</span> <span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;acres&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span>
<span class="n">is_in_sd</span> <span class="o">=</span> <span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;San Diego&#39;</span>
<span class="n">is_in_1990s</span> <span class="o">=</span> <span class="p">(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1990</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">calfire</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can perform the query. All three of these conditions must be true simultaneously, so we use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calfire</span><span class="p">[</span><span class="n">is_gt_1000_acres</span> <span class="o">&amp;</span> <span class="n">is_in_sd</span> <span class="o">&amp;</span> <span class="n">is_in_1990s</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="accessing.html" title="previous page">Accessing and Sorting</a>
    <a class='right-next' id="next-link" href="groupby.html" title="next page">GroupBy</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Parker Addison and Justin Eldridge<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>